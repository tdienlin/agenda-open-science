---
title: "An Agenda for Open Science in Communication"
---

```{r warning=F, message=F}
library(magrittr); library(pwr); library(tidyverse)
d <- read.csv("data.csv")
d %<>% 
  mutate(
    Mean.n.k = Mean.n / Mean.k,
    Median.n.k = Median.n / d$Median.k
  ) %>% 
  mutate(
    Mean.pwr.k = pwr.r.test(Mean.n.k, Mean.r)$power,
    Median.pwr.k = pwr.r.test(Median.n.k, Median.r)$power,
    Median.pwr.10 = pwr.r.test(Median.n.k, .1)$power,
    Median.pwr.15 = pwr.r.test(Median.n.k, .15)$power,
    Median.pwr.20 = pwr.r.test(Median.n.k, .2)$power,
  ) %>% 
  mutate_at(vars(SD.n, Mean.n.k, Median.n.k), funs(round(., 0))) %>% 
  mutate_at(vars(contains("pwr")), funs(round(., 2))) %>% 
  select(
    "Topic area" = Topic.area, 
    "Effect: Median r" = Median.r,
    "Effect: Median N" = Median.n.k,
    "Power: r = Median r" = Median.pwr.k,
    "Power: r = .10" = Median.pwr.10,
    "Power: r = .15" = Median.pwr.15,
    "Power: r = .20" = Median.pwr.20
  ) %>% 
  print() %>% 
  write.csv("table_1.csv", row.names = FALSE)
```

